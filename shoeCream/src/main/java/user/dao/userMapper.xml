<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userSQL">
	<!-- 전체 목록 -->
	<select id="getUserForm" parameterType="java.util.Map" resultType="user">
		SELECT * FROM user_table ORDER BY userId DESC
	</select>
	
	<select id="getUserId" parameterType="int" resultType="user">
		SELECT * FROM user_table WHERE userId=#{userId}
	</select>

	<!-- 회원가입 -->
	<insert id="joinOk" parameterType="user">
		INSERT INTO user_table(userId, username, pwd, fullName, email, phoneNum, lastDate, regDate)
						VALUES(seq_user_table.nextval, #{username}, #{pwd}, #{fullName}, #{email}, #{phoneNum}, sysdate, sysdate)
	</insert>
	
	<!-- 소셜 회원가입 -->
	<insert id="joinSocialOk" parameterType="user">
		INSERT INTO user_table(userId, email, username, phoneNum, fullName, img, accessToken, platformType, lastDate, regDate)
						VALUES(seq_user_table.nextval, #{email}, #{username}, #{phoneNum}, #{fullName}, #{img}, #{accessToken}, '카카오', sysdate, sysdate)
	</insert>
	
	<!-- 아이디, 비밀번호 확인 -->
	<select id="chkUserPwd" parameterType="java.util.Map" resultType="user">
		SELECT * FROM user_table WHERE username=#{username} and pwd=#{pwd}
	</select>
	
	<!-- 로그인 -->
	<update id="loginOk" parameterType="String">
		UPDATE user_table SET lastDate=sysdate WHERE username=#{username}
	</update>
	
	<!-- 소셜 로그인 -->
	<update id="kakaoLoginOk" parameterType="String">
		UPDATE user_table SET lastDate=sysdate WHERE email=#{email}
	</update>
	
	<!-- 아이디 확인 -->
	<select id="chkUsername" parameterType="String" resultType="user">
		SELECT * FROM user_table WHERE username=#{username}
	</select>
	
	<!-- 이메일 확인 -->
	<select id="chkEmail" parameterType="String" resultType="user">
		SELECT * FROM user_table WHERE email=#{email}
	</select>
	
	<!-- 아이디 찾기 -->
	<select id="findUserOk" parameterType="String" resultType="String">
		SELECT username FROM user_table WHERE phoneNum=#{phoneNum}
	</select>
	
	<!-- 비밀번호 찾기 -->
	<select id="findPwdOk" parameterType="java.util.Map" resultType="user">
		SELECT * FROM user_table WHERE phoneNum=#{phoneNum} and username=#{username}
	</select>

	<!-- 비밀번호 수정 -->
	<update id="updatePwd" parameterType="java.util.Map">
		UPDATE user_table SET pwd=#{pwd} WHERE username=#{username}
	</update>
	
	<!-- 아이디 변경 -->
	<update id="updateUsername" parameterType="user">
		UPDATE user_table SET username=#{username} WHERE userId=#{userId}
	</update>
	
	<!-- 이메일 주소 변경 -->
	<update id="updateEmail" parameterType="user">
		UPDATE user_table SET email=#{email} WHERE userId=#{userId}
	</update>
	
	<!-- 이름 변경 -->
	<update id="updateFullName" parameterType="user">
		UPDATE user_table SET fullName=#{fullName} WHERE userId=#{userId}
	</update>
	
	<!-- 휴대폰 번호 변경 -->
	<update id="updatePhoneNum" parameterType="user">
		UPDATE user_table SET phoneNum=#{phoneNum} WHERE userId=#{userId}
	</update>
	
</mapper> 