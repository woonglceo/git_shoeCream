<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="styleSQL">
	<!-- StyleBoardDTO List가져오기 (인기도 순) -->
	<select id="getListOrderByPopularity" resultType="StyleBoardDTO">
		select * from style_board order by likecount desc
	</select>
	
	<!-- StyleBoardDTO List가져오기 (최신 순) -->
	<select id="getListOrderByRecentDate" resultType="StyleBoardDTO">
		select * from style_board order by regdate desc
	</select>
	
	<!-- StyleBoardDTO List가져오기 (특정 회원) -->
	<select id="getMyList" parameterType="Integer" resultType="StyleBoardDTO">
		select * from style_board where userId=#{userId} order by regdate desc
	</select>
	
	<!-- 특정 게시물 댓글 갯수 -->
	<select id="totalMyStyle" parameterType="Integer" resultType="Integer">
		select count(*) from style_board where styleId=#{styleId}
	</select>
	
	<!-- 특정 회원 게시글 갯수 -->
	<select id="totalComment" parameterType="Integer" resultType="Integer">
		select count(*) from style_board where userId=#{userId}
	</select>
	
	<!-- 특정 게시물을 작성한 유저 정보 -->
	<select id="getUserByUserId" parameterType="Integer" resultType="user">
		select * from user_table where userId=#{userId}
	</select>
	
	<!-- 상품id로 상품 찾기 -->
	<select id="getProductByProductId" parameterType="Integer" resultType="product">
		select * from product_table where productId=#{productId}
	</select>
	
	<!-- 상품id로 해당 상품의 최저가 찾기 -->
	<select id="getLowestPriceByProductId" parameterType="Integer" resultType="Integer">
		select price from (select rownum rn, total.* from (select * from sales_table where productId=#{productId} and status=0 order by price asc)total) where rn=1
	</select>
	
	<!-- 게시물의 댓글 리스트 -->
	<select id="getReplyList" parameterType="Integer" resultType="StyleReplyDTO">
		select * from style_reply where styleId=#{styleId}
	</select>
</mapper>